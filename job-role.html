<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ATS Resume Analyzer | Resume Builder</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
    /* --- MINIMAL THEME VARIABLES --- */
    :root {
        --primary: #2563eb;       /* Royal Blue */
        --primary-dark: #1e40af;
        --text-main: #0f172a;     /* Dark Slate */
        --text-light: #64748b;    /* Light Slate */
        --bg-body: #f8fafc;       /* Light Gray Background */
        --bg-card: #ffffff;       /* White Card Background */
        --border: #e2e8f0;
        --danger: #ef4444;        /* Soft Red for missing keywords */
        --danger-light: #fee2e2;
        --success: #10b981;
        --transition: all 0.2s ease;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
        font-family: 'Plus Jakarta Sans', sans-serif;
        background-color: var(--bg-body);
        color: var(--text-main);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow-x: hidden;
        padding: 20px;
    }

    /* --- Remove Background Blobs for Minimal Look --- */
    .blob { display: none; }

    /* --- Dashboard Container --- */
    .container {
        background: var(--bg-card);
        border: 1px solid var(--border);
        max-width: 1100px;
        width: 100%;
        padding: 40px;
        border-radius: 16px;
        box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.05);
        animation: fadeIn 0.5s ease-out forwards;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* --- Two Column Dashboard Grid --- */
    .dashboard-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 40px;
        align-items: stretch;
    }

    /* --- Left Panel: Upload & Inputs --- */
    .left-panel {
        display: flex;
        flex-direction: column;
    }

    h2 { 
        font-weight: 700; 
        font-size: 1.8rem; 
        margin-bottom: 8px; 
        color: var(--text-main);
        letter-spacing: -0.5px; 
    }
    
    p { 
        color: var(--text-light); 
        margin-bottom: 25px; 
        font-size: 1rem;
    }

    /* --- Styled Drop Zone (Clean) --- */
    .drop-zone {
        border: 2px dashed var(--border);
        border-radius: 12px;
        padding: 30px 20px;
        background: var(--bg-body);
        color: var(--text-light);
        cursor: pointer;
        margin-bottom: 20px;
        transition: var(--transition);
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        gap: 10px;
    }
    
    .drop-zone i {
        font-size: 30px;
        color: var(--text-light);
        transition: var(--transition);
    }

    .drop-zone.dragover {
        border-color: var(--primary);
        background: #eff6ff; /* Light blue */
        color: var(--primary);
    }
    
    .drop-zone.dragover i { color: var(--primary); }
    
    .drop-zone.ready {
        border-color: var(--success);
        background: #f0fdf4;
        color: var(--success);
    }
    .drop-zone.ready i { color: var(--success); }

    .drop-zone span { 
        font-size: 0.95rem; 
        font-weight: 500;
    }

    /* --- Inputs & Selects (Minimalist) --- */
    input, select {
        width: 100%;
        padding: 12px 16px;
        margin-bottom: 15px;
        border-radius: 8px;
        border: 1px solid var(--border);
        background: var(--bg-card);
        color: var(--text-main);
        font-size: 0.95rem;
        font-family: inherit;
        transition: var(--transition);
    }

    input:focus, select:focus {
        border-color: var(--primary);
        outline: none;
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }
    
    select option {
        background-color: #ffffff;
        color: #0f172a;
        font-size: 0.95rem;
    }

    /* --- Search Results Dropdown --- */
    .role-results {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 8px;
        margin-top: -10px;
        margin-bottom: 15px;
        max-height: 200px;
        overflow-y: auto;
        position: absolute;
        width: 100%;
        z-index: 9999; /* Increased to ensure it floats above dropdowns */
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        display: none; /* Handled by JS dynamically if empty */
    }
    
    .role-results:not(:empty) { display: block; }

    .role-results::-webkit-scrollbar { width: 6px; }
    .role-results::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

    .role-item {
        padding: 10px 16px;
        cursor: pointer;
        font-size: 0.95rem;
        border-bottom: 1px solid var(--bg-body);
        transition: var(--transition);
    }

    .role-item:hover {
        background: #eff6ff;
        color: var(--primary);
        padding-left: 20px;
    }

    /* --- Button Effects (Solid & Professional) --- */
    .button-group { 
        display: flex; 
        gap: 15px; 
        margin-top: auto;
    }
    
    button {
        flex: 1;
        padding: 12px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.95rem;
        cursor: pointer;
        transition: var(--transition);
        font-family: inherit;
        border: none;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
    }
    
    .btn-primary {
        background: var(--primary);
        color: white;
        border: 1px solid var(--primary);
    }
    
    .btn-primary:hover { 
        background: var(--primary-dark); 
        border-color: var(--primary-dark);
        transform: translateY(-2px);
    }
    
    .btn-outline { 
        background: white; 
        color: var(--text-main);
        border: 1px solid var(--border);
    }
    
    .btn-outline:hover { 
        background: var(--bg-body); 
        border-color: var(--text-light);
    }

    /* --- Right Panel: Results --- */
    .right-panel {
        background: var(--bg-body);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 30px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 450px;
    }

    /* Empty State Placeholder */
    .empty-state {
        text-align: center;
        color: var(--text-light);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 15px;
    }
    .empty-state i { font-size: 3rem; opacity: 0.3; }
    .empty-state span { font-size: 1.05rem; font-weight: 500; }

    /* Results Content */
    #result { width: 100%; text-align: center; animation: fadeIn 0.4s ease; }
    #result h3 { color: var(--danger); font-size: 1.3rem; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; gap: 8px; }
    
    .keyword-box {
        background: white;
        border: 1px dashed var(--border);
        padding: 25px;
        border-radius: 12px;
        margin: 20px 0;
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
        min-height: 150px;
        align-content: flex-start;
    }

    .keyword {
        background: var(--danger-light);
        color: var(--danger);
        padding: 6px 14px;
        border-radius: 50px;
        font-size: 0.85rem;
        font-weight: 600;
        border: 1px solid #fca5a5;
        animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        opacity: 0;
        transform: scale(0.5);
    }

    .keyword:nth-child(n) { animation-delay: 0.05s; }
    .keyword:nth-child(2n) { animation-delay: 0.1s; }
    .keyword:nth-child(3n) { animation-delay: 0.15s; }

    @keyframes popIn { to { opacity: 1; transform: scale(1); } }

    /* Mobile Adjustments */
    @media (max-width: 800px) {
        .dashboard-grid { grid-template-columns: 1fr; gap: 30px; }
        .right-panel { min-height: 350px; }
        .container { padding: 30px 20px; }
        .button-group { flex-direction: column; }
    }
</style>
</head>

<body>

<div class="blob"></div>
<div class="blob blob-2"></div>

<div class="container">
    <div class="dashboard-grid">
        
        <div class="left-panel">
            <h2><i class="fas fa-radar" style="color: var(--primary); margin-right: 8px;"></i>Role Matcher</h2>
            <p>Upload your resume and check compatibility against AI job filters.</p>

            <div class="drop-zone" id="dropZone">
                <i class="fas fa-cloud-upload-alt" id="dropIcon"></i>
                <span id="dropText">Drag & Drop PDF or Click to Upload</span>
                <input type="file" id="fileInput" accept=".pdf" hidden>
            </div>

            <div style="position: relative;">
                <input type="text" placeholder="ðŸ” Search for your target role..." onkeyup="searchRole(this.value)">
                <div class="role-results" id="roleResults"></div>
            </div>

            <select id="roleSelect">
                <option value="">Select Job Role manually</option>
            </select>

            <div class="button-group">
                <button class="btn-primary" onclick="analyzeResume()">
                    <i class="fas fa-microchip"></i> Run Analysis
                </button>
                <button class="btn-outline" onclick="goDashboard()">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
            </div>
        </div>

        <div class="right-panel">
            <div class="empty-state" id="emptyState">
                <i class="fas fa-search"></i>
                <span>Keyword analysis will appear here</span>
            </div>

            <div id="result" style="display:none">
                <h3><i class="fas fa-exclamation-triangle"></i> Missing ATS Keywords</h3>
                <p style="font-size: 0.9rem; margin-bottom: 10px;">Add these exact words to your resume to pass the bot filters:</p>
                
                <div class="keyword-box" id="missingKeywords"></div>

                <button class="btn-outline" onclick="copyKeywords()" style="margin: 0 auto; width: auto; padding: 10px 20px;">
                    <i class="fas fa-copy"></i> Copy Keywords
                </button>
            </div>
        </div>

    </div>
</div>

<script>
// ================== EXPANDED JOB ROLES (LOGIC UNTOUCHED) ==================
const roleKeywords = {
 // Software & Engineering
 "Software Engineer": ["JavaScript", "HTML", "CSS", "APIs", "Git", "REST", "Agile"],
 "Frontend Developer": ["React", "CSS", "JavaScript", "Accessibility", "Vue", "TypeScript", "Responsive Design"],
 "Backend Developer": ["Node.js", "Databases", "REST", "Auth", "Python", "Java", "Microservices", "API"],
 "Full Stack Developer": ["React", "Node.js", "SQL", "Git", "MongoDB", "Express", "REST"],
 "DevOps Engineer": ["Docker", "Kubernetes", "CI/CD", "AWS", "Jenkins", "Linux", "Automation", "Terraform"],
 "Cloud Engineer": ["AWS", "Azure", "Terraform", "GCP", "Docker", "IaaS", "Cloud Security"],
 "Site Reliability Engineer": ["Linux", "Kubernetes", "Monitoring", "CI/CD", "Automation", "Python", "SLA"],
 "QA Engineer": ["Testing", "Automation", "Selenium", "Jira", "Postman", "Cypress", "Bug Tracking"],
 "Mobile App Developer": ["Android", "iOS", "Flutter", "React Native", "Swift", "Kotlin", "Mobile UI"],
 "Game Developer": ["Unity", "C#", "Unreal Engine", "C++", "3D Modeling", "Game Physics"],
 "Blockchain Developer": ["Solidity", "Smart Contracts", "Web3", "Cryptography", "Ethereum"],
 "Embedded Engineer": ["C", "Microcontrollers", "C++", "IoT", "RTOS", "Hardware"],
 "Network Engineer": ["Networking", "Firewalls", "Cisco", "Routing", "TCP/IP", "VPN"],
 "IT Support Specialist": ["Troubleshooting", "Active Directory", "Ticketing", "Windows", "Networking", "Hardware Support"],

 // Data & AI
 "Data Analyst": ["Excel", "SQL", "Python", "Statistics", "Tableau", "Data Visualization", "Power BI"],
 "Data Scientist": ["Python", "ML", "Pandas", "NumPy", "Predictive Modeling", "R", "Algorithms"],
 "Data Engineer": ["SQL", "ETL", "Spark", "Hadoop", "Python", "Data Warehousing", "AWS"],
 "Machine Learning Engineer": ["Python", "TensorFlow", "PyTorch", "NLP", "Deep Learning", "Algorithms"],
 "AI Engineer": ["ML", "TensorFlow", "Python", "Computer Vision", "NLP", "Deep Learning"],

 // Design & Product
 "UI UX Designer": ["Figma", "Wireframes", "UX", "Prototyping", "User Research", "Adobe XD"],
 "UX Researcher": ["User Interviews", "Usability Testing", "Wireframing", "Persona", "Figma", "A/B Testing"],
 "Product Designer": ["Prototyping", "Figma", "Design Thinking", "User-Centered", "UI/UX", "Visual Design"],
 "Product Manager": ["Roadmap", "Agile", "Strategy", "Jira", "Stakeholder Management", "User Stories", "Go-to-market"],
 "Scrum Master": ["Agile", "Scrum", "Kanban", "Sprint Planning", "Jira", "Facilitation"],
 "Graphic Designer": ["Photoshop", "Creativity", "Illustrator", "InDesign", "Branding", "Typography"],

 // Business, Management & Sales
 "Business Analyst": ["Documentation", "Analysis", "Requirements Gathering", "SQL", "Process Modeling", "UML"],
 "Project Manager": ["PMP", "Agile", "Scrum", "Risk Management", "Budgeting", "Scheduling", "Leadership"],
 "Operations Manager": ["Process", "Operations", "KPIs", "Supply Chain", "Vendor Management", "Strategy"],
 "Sales Executive": ["Sales", "CRM", "B2B", "Lead Generation", "Negotiation", "Cold Calling"],
 "Account Executive": ["B2B Sales", "CRM", "Negotiation", "Lead Generation", "Closing", "Account Management"],
 "Supply Chain Manager": ["Logistics", "Procurement", "Inventory Management", "ERP", "Negotiation", "Vendor Management"],

 // Marketing
 "Digital Marketer": ["SEO", "Analytics", "Google Ads", "SEM", "Campaign Management", "Social Media"],
 "SEO Specialist": ["SEO", "Google Analytics", "Keyword Research", "On-page", "Link Building", "Ahrefs"],
 "Social Media Manager": ["Content Strategy", "Hootsuite", "Copywriting", "Campaigns", "Engagement", "Brand Awareness"],
 "Content Writer": ["SEO", "Copywriting", "Editing", "WordPress", "Content Strategy", "Blogging"],
 
 // Finance & Accounting
 "Finance Analyst": ["Finance", "Excel", "Financial Modeling", "Forecasting", "Variance Analysis", "Reporting"],
 "Accountant": ["GST", "Tally", "QuickBooks", "Reconciliation", "Taxation", "Accounts Payable"],
 "Investment Banker": ["Financial Modeling", "Valuation", "M&A", "Excel", "Bloomberg", "Pitch Books"],

 // Traditional Engineering
 "Mechanical Engineer": ["AutoCAD", "SolidWorks", "Thermodynamics", "Manufacturing", "Design", "FEA"],
 "Electrical Engineer": ["Circuit Design", "PCB", "AutoCAD Electrical", "Testing", "MATLAB", "Power Systems"],
 "Civil Engineer": ["AutoCAD", "Structural Analysis", "Project Management", "Surveying", "AutoCAD Civil 3D"],

 // HR & Admin
 "HR Executive": ["Recruitment", "HR Policies", "Onboarding", "Employee Relations", "Payroll", "Compliance"],
 "Talent Acquisition Specialist": ["Sourcing", "Applicant Tracking Systems", "Interviewing", "Onboarding", "LinkedIn Recruiter", "Networking"],
 
 // Other/Miscellaneous
 "Cyber Security Analyst": ["Security", "PenTesting", "Firewalls", "Vulnerability Assessment", "SIEM", "Incident Response"],
 "Database Administrator": ["SQL", "Backups", "Oracle", "MySQL", "Performance Tuning", "Database Security"],
 "Teacher": ["Teaching", "Planning", "Curriculum Development", "Classroom Management", "Communication"],
 "Student": ["Projects", "Learning", "Research", "Teamwork", "Problem Solving", "Time Management"]
};

// Populate dropdown (UPDATED FIX)
const roleSelect = document.getElementById("roleSelect");
Object.keys(roleKeywords).forEach(role => {
    const option = document.createElement("option");
    option.value = role;
    option.textContent = role;
    roleSelect.appendChild(option);
});

// ================== ROLE SEARCH ==================
function searchRole(text){
    const resultBox = document.getElementById("roleResults");
    resultBox.innerHTML = "";

    if(!text) return;

    Object.keys(roleKeywords).filter(role =>
        role.toLowerCase().includes(text.toLowerCase())
    ).forEach(role=>{
        const div = document.createElement("div");
        div.className = "role-item";
        div.textContent = role;
        div.onclick = () => {
            roleSelect.value = role;
            resultBox.innerHTML = "";
            // Clear input text visually
            document.querySelector("input[type='text']").value = role;
        };
        resultBox.appendChild(div);
    });
}

// ================== FILE UPLOAD ==================
const dropZone = document.getElementById("dropZone");
const fileInput = document.getElementById("fileInput");
const dropText = document.getElementById("dropText");
const dropIcon = document.getElementById("dropIcon");
let extractedText = "";

dropZone.onclick = () => fileInput.click();
dropZone.ondragover = e => e.preventDefault();
dropZone.ondrop = e => {
    e.preventDefault();
    handleFile(e.dataTransfer.files[0]);
};

fileInput.onchange = e => handleFile(e.target.files[0]);

async function handleFile(file){
    if(!file || file.type!=="application/pdf"){
        alert("PDF only");
        return;
    }

    dropZone.classList.add("ready");
    dropIcon.className = "fas fa-check-circle";
    dropText.innerHTML = `${file.name} Uploaded`;

    const reader = new FileReader();
    reader.onload = async ()=>{
        const pdf = await pdfjsLib.getDocument(new Uint8Array(reader.result)).promise;
        extractedText="";
        for(let i=1;i<=pdf.numPages;i++){
            const page = await pdf.getPage(i);
            const content = await page.getTextContent();
            extractedText += content.items.map(i=>i.str).join(" ")+" ";
        }
        localStorage.setItem("pdfResumeText", extractedText);
        localStorage.setItem("resumeSource","pdf");
    };
    reader.readAsArrayBuffer(file);
}

// ================== ANALYSIS ==================
function analyzeResume(){
    const role = roleSelect.value;
    if(!role || !extractedText){
        alert("Upload resume and select role");
        return;
    }

    const missing = roleKeywords[role].filter(k =>
        !extractedText.toLowerCase().includes(k.toLowerCase())
    );

    const box = document.getElementById("missingKeywords");
    box.innerHTML="";
    
    if(missing.length === 0) {
        box.innerHTML = "<span style='color: var(--success); font-weight: 600;'><i class='fas fa-check-circle'></i> Perfect Match! No missing keywords.</span>";
    } else {
        missing.forEach(k=>{
            box.innerHTML+=`<span class="keyword">${k}</span>`;
        });
    }

    localStorage.setItem("missingKeywords",JSON.stringify(missing));
    
    // UI Updates
    document.getElementById("emptyState").style.display = "none";
    document.getElementById("result").style.display = "block";
}

// ================== BUTTONS ==================
function copyKeywords(){
    const kw = JSON.parse(localStorage.getItem("missingKeywords")) || [];
    if(kw.length === 0) {
        alert("No keywords to copy!");
        return;
    }
    navigator.clipboard.writeText(kw.join(", "));
    alert("Keywords copied to clipboard!");
}

function goDashboard(){
    window.location.href="dashboard.html";
}
</script>

</body>
</html>