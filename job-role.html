<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ATS Resume Analyzer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #6a0dad, #9b59b6);
    padding: 40px;
}

.container {
    max-width: 1000px;
    margin: auto;
    background: white;
    padding: 40px;
    border-radius: 18px;
}

h2 {
    font-family: Poppins, sans-serif;
}

.drop-zone {
    border: 2px dashed #6a0dad;
    padding: 30px;
    border-radius: 12px;
    text-align: center;
    font-weight: bold;
    color: #6a0dad;
    cursor: pointer;
    margin-bottom: 20px;
}

.drop-zone.ready {
    background: #e8dcff;
}

input, select, button {
    width: 100%;
    padding: 12px;
    margin-top: 10px;
    border-radius: 8px;
    border: 1px solid #ccc;
}

button {
    background: #6a0dad;
    color: white;
    border: none;
    cursor: pointer;
}

button:hover {
    background: #5a0cb0;
}

.role-results {
    background: #f5f0ff;
    border-radius: 8px;
    margin-top: 5px;
    max-height: 150px;
    overflow-y: auto;
}

.role-item {
    padding: 10px;
    cursor: pointer;
}

.role-item:hover {
    background: #ddd;
}

.keyword-box {
    background: #f5f0ff;
    padding: 15px;
    border-radius: 8px;
    margin-top: 15px;
}

.keyword {
    display: inline-block;
    background: #ddd;
    padding: 6px 10px;
    border-radius: 15px;
    margin: 5px;
    font-size: 13px;
}
</style>
</head>

<body>

<div class="container">
<h2>ATS Resume Analyzer</h2>
<p>Upload your resume and choose the job role you are applying for.</p>



<!-- FILE UPLOAD -->
<div class="drop-zone" id="dropZone">
    <span id="dropText">Drop resume PDF here or click to upload</span>
    <input type="file" id="fileInput" accept=".pdf" hidden>
</div>

<!-- ROLE SEARCH -->
<input type="text" placeholder="Search job role..." onkeyup="searchRole(this.value)">

<div class="role-results" id="roleResults"></div>

<select id="roleSelect">
    <option value="">Select Job Role</option>
</select>

<button onclick="analyzeResume()">Analyze Resume</button>
<!-- DASHBOARD BUTTON -->
<button onclick="goDashboard()">Go to Dashboard</button>

<!-- RESULTS -->
<div id="result" style="display:none">
<h3>Missing ATS Keywords</h3>
<div class="keyword-box" id="missingKeywords"></div>

<button onclick="copyKeywords()">Copy Keywords</button>
<button onclick="continueEdit()">Continue to Edit Resume</button>
</div>

</div>

<script>
// ================== JOB ROLES ==================
const roleKeywords = {
 "Software Engineer":["JavaScript","HTML","CSS","APIs","Git"],
 "Frontend Developer":["React","CSS","JavaScript","Accessibility"],
 "Backend Developer":["Node.js","Databases","REST","Auth"],
 "Full Stack Developer":["React","Node.js","SQL","Git"],
 "Data Analyst":["Excel","SQL","Python","Statistics"],
 "Data Scientist":["Python","ML","Pandas","NumPy"],
 "DevOps Engineer":["Docker","Kubernetes","CI/CD","AWS"],
 "Cloud Engineer":["AWS","Azure","Terraform"],
 "Cyber Security Analyst":["Security","PenTesting"],
 "UI UX Designer":["Figma","Wireframes","UX"],
 "Mobile App Developer":["Android","iOS","Flutter"],
 "AI Engineer":["ML","TensorFlow","Python"],
 "QA Engineer":["Testing","Automation","Selenium"],
 "Product Manager":["Roadmap","Agile","Strategy"],
 "Business Analyst":["Documentation","Analysis"],
 "HR Executive":["Recruitment","HR Policies"],
 "Digital Marketer":["SEO","Analytics"],
 "Content Writer":["SEO","Copywriting"],
 "Graphic Designer":["Photoshop","Creativity"],
 "Network Engineer":["Networking","Firewalls"],
 "Database Administrator":["SQL","Backups"],
 "Game Developer":["Unity","C#"],
 "Blockchain Developer":["Solidity","Smart Contracts"],
 "Embedded Engineer":["C","Microcontrollers"],
 "Finance Analyst":["Finance","Excel"],
 "Accountant":["GST","Tally"],
 "Sales Executive":["Sales","CRM"],
 "Operations Manager":["Process","Operations"],
 "Teacher":["Teaching","Planning"],
 "Student":["Projects","Learning"]
};

// Populate dropdown
const roleSelect = document.getElementById("roleSelect");
Object.keys(roleKeywords).forEach(role=>{
    roleSelect.innerHTML += `<option value="${role}">${role}</option>`;
});

// ================== ROLE SEARCH ==================
function searchRole(text){
    const resultBox = document.getElementById("roleResults");
    resultBox.innerHTML = "";

    if(!text) return;

    Object.keys(roleKeywords).filter(role =>
        role.toLowerCase().includes(text.toLowerCase())
    ).forEach(role=>{
        const div = document.createElement("div");
        div.className = "role-item";
        div.textContent = role;
        div.onclick = () => {
            roleSelect.value = role;
            resultBox.innerHTML = "";
        };
        resultBox.appendChild(div);
    });
}

// ================== FILE UPLOAD ==================
const dropZone = document.getElementById("dropZone");
const fileInput = document.getElementById("fileInput");
const dropText = document.getElementById("dropText");
let extractedText = "";

dropZone.onclick = () => fileInput.click();
dropZone.ondragover = e => e.preventDefault();
dropZone.ondrop = e => {
    e.preventDefault();
    handleFile(e.dataTransfer.files[0]);
};

fileInput.onchange = e => handleFile(e.target.files[0]);

async function handleFile(file){
    if(!file || file.type!=="application/pdf"){
        alert("PDF only");
        return;
    }

    dropZone.classList.add("ready");
    dropText.textContent = `âœ” ${file.name} ready`;

    const reader = new FileReader();
    reader.onload = async ()=>{
        const pdf = await pdfjsLib.getDocument(new Uint8Array(reader.result)).promise;
        extractedText="";
        for(let i=1;i<=pdf.numPages;i++){
            const page = await pdf.getPage(i);
            const content = await page.getTextContent();
            extractedText += content.items.map(i=>i.str).join(" ")+" ";
        }
        localStorage.setItem("pdfResumeText", extractedText);
        localStorage.setItem("resumeSource","pdf");
    };
    reader.readAsArrayBuffer(file);
}

// ================== ANALYSIS ==================
function analyzeResume(){
    const role = roleSelect.value;
    if(!role || !extractedText){
        alert("Upload resume and select role");
        return;
    }

    const missing = roleKeywords[role].filter(k =>
        !extractedText.toLowerCase().includes(k.toLowerCase())
    );

    const box = document.getElementById("missingKeywords");
    box.innerHTML="";
    missing.forEach(k=>{
        box.innerHTML+=`<span class="keyword">${k}</span>`;
    });

    localStorage.setItem("missingKeywords",JSON.stringify(missing));
    document.getElementById("result").style.display="block";
}

// ================== BUTTONS ==================
function copyKeywords(){
    const kw = JSON.parse(localStorage.getItem("missingKeywords")) || [];
    navigator.clipboard.writeText(kw.join(", "));
    alert("Keywords copied");
}

function continueEdit(){
    window.location.href="/form-edit.html";
}

function goDashboard(){
    window.location.href="/dashboard.html";
}
</script>

</body>
</html>
