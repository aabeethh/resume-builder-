<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Resume Preview</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600&display=swap" rel="stylesheet">

<style>
/* ===== PAGE ===== */
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #6a0dad, #9b59b6);
    padding: 40px;
}

.container {
    display: flex;
    gap: 30px;
    max-width: 1200px;
    margin: auto;
}

/* ===== ACTION PANEL ===== */
.actions {
    width: 220px;
    background: #fff;
    padding: 25px;
    border-radius: 14px;
    height: fit-content;
}

.actions h3 {
    font-family:Poppins;
}

.actions button {
    width: 100%;
    padding: 12px;
    margin-bottom: 12px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
}

.download-btn {
    background: #6a0dad;
    color: #fff;
}

/* ===== COMMON RESUME BASE ===== */
.resume {
    background: #fff;
    padding: 40px;
    border-radius: 18px;
    flex: 1;
    display: none;
}

/* ================= TEMPLATE 1 ================= */

.template-clean h1 {
    font-size: 34px;
}

.template-clean h3 {
    border-bottom: 2px solid #000;
    margin-top: 25px;
}

.template-clean ul {
    padding-left: 20px;
}

/* ================= TEMPLATE 2 ================= */

.template-sidebar {
    display: grid;
    grid-template-columns: 30% 70%;
}

.sidebar {
    background: #f2e8dc;
    padding: 25px;
}

.main {
    padding: 30px;
}

.sidebar h3 {
    border-bottom: 1px solid #000;
}

/* ================= TEMPLATE 3 ================= */

.template-ats h3 {
    border-bottom: 1px solid #000;
    text-transform: uppercase;
    font-size: 14px;
}

@media print {
    body { background: none; padding: 0; }
    .actions { display: none; }
}
</style>
</head>

<body>

<div class="container">

<!-- ACTIONS -->
<div class="actions">
    <h3>Actions</h3>

    <button onclick="editResume()">Edit Resume</button>

    <button onclick="changeTemplate()">Change Template</button>

    <button onclick="goToCreate()">Create New Resume</button>

    <button class="download-btn" onclick="window.print()">
        Download / Print
    </button>
</div>


<!-- ================= TEMPLATE 1 ================= -->
<div class="resume template-clean" id="template-clean">
    <h1 id="name"></h1>
    <p id="contact"></p>

    <h3>Professional Summary</h3>
    <p id="summary"></p>

    <h3>Work Experience</h3>
    <p id="experience"></p>

    <h3>Education</h3>
    <p id="education"></p>

    <h3>Skills</h3>
    <ul id="skills"></ul>
</div>

<!-- ================= TEMPLATE 2 ================= -->
<div class="resume template-sidebar" id="template-sidebar">
    <div class="sidebar">
        <h2 id="name2"></h2>
        <p id="contact2"></p>

        <h3>Skills</h3>
        <ul id="skills2"></ul>
    </div>

    <div class="main">
        <h3>Summary</h3>
        <p id="summary2"></p>

        <h3>Experience</h3>
        <p id="experience2"></p>

        <h3>Education</h3>
        <p id="education2"></p>
    </div>
</div>

<!-- ================= TEMPLATE 3 ================= -->
<div class="resume template-ats" id="template-ats">
    <h1 id="name3"></h1>
    <p id="contact3"></p>

    <h3>Summary</h3>
    <p id="summary3"></p>

    <h3>Experience</h3>
    <p id="experience3"></p>

    <h3>Education</h3>
    <p id="education3"></p>

    <h3>Skills</h3>
    <p id="skills3"></p>
</div>

</div>


<script>
const data = JSON.parse(localStorage.getItem("resumeData"));
if (!data) {
    alert("No resume data found");
    window.location.href = "/resume-options.html";
}

// Debug: Check data and summary
console.log("Resume Data:", data);
console.log("Summary Value:", data.summary);

// hide all templates
document.querySelectorAll(".resume").forEach(r => r.style.display = "none");

// get selected template
const selected = localStorage.getItem("selectedTemplate");

// map template name â†’ DOM id
const templateMap = {
    clean: "template-clean",
    sidebar: "template-sidebar",
    ats: "template-ats"
};

// fallback (never blank again)
const templateId = templateMap[selected] || "template-clean";

// show selected template
document.getElementById(templateId).style.display = "block";

/* ==== Populate content ==== */
function set(id, val) {
    const el = document.getElementById(id);
    if (el) {
        const trimmed = (val || "").trim();
        el.textContent = trimmed || "No summary available";  // Shows a message if empty
    }
}

set("name", data.name);
set("contact", `${data.email} | ${data.phone}`);
set("summary", data.summary);
set("experience", data.experience);
set("education", data.education);

if (document.getElementById("skills")) {
    document.getElementById("skills").innerHTML =
        data.skills.split(",").map(s => `<li>${s.trim()}</li>`).join("");
}

/* sidebar */
set("name2", data.name);
set("contact2", data.email);
set("summary2", data.summary);
set("experience2", data.experience);
set("education2", data.education);

if (document.getElementById("skills2")) {
    document.getElementById("skills2").innerHTML =
        data.skills.split(",").map(s => `<li>${s.trim()}</li>`).join("");
}

/* ats */
set("name3", data.name);
set("contact3", `${data.email} | ${data.phone}`);
set("summary3", data.summary);
set("experience3", data.experience);
set("education3", data.education);
set("skills3", data.skills);

function editResume() {
    window.location.href = "/form-edit.html";
}
//changes the template being viewed
const templates = ["clean", "sidebar", "ats"];

function changeTemplate() {
    let current = localStorage.getItem("selectedTemplate") || "clean";
    let index = templates.indexOf(current);

    // move to next template
    let nextIndex = (index + 1) % templates.length;
    let nextTemplate = templates[nextIndex];

    localStorage.setItem("selectedTemplate", nextTemplate);

    // hide all templates
    document.querySelectorAll(".resume").forEach(r => {
        r.style.display = "none";
    });

    // show new template
    const map = {
        clean: "template-clean",
        sidebar: "template-sidebar",
        ats: "template-ats"
    };

    document.getElementById(map[nextTemplate]).style.display = "block";

    // Re-set summary for the new template
    const summaryId = nextTemplate === "sidebar" ? "summary2" : nextTemplate === "ats" ? "summary3" : "summary";
    set(summaryId, data.summary);
}
//goes to the resume creation page

function goToCreate() {
    // optional: clear previous resume data
    localStorage.removeItem("resumeData");
    localStorage.removeItem("resumeSource");
    localStorage.removeItem("pdfResumeText");
    localStorage.removeItem("selectedTemplate");

    window.location.href = "/resume-options.html";
}


</script>



</body>
</html>